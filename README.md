Intensity Functional Principal Component Analysis (IFPCA)
================

## New Implementation

``` r
library(doParallel)
```

    ## Loading required package: foreach

    ## Loading required package: iterators

    ## Loading required package: parallel

``` r
url <- "https://raw.githubusercontent.com/celehs/MASTA/master/R/"
source(paste0(url, "masta-fpca-kern.R"))
source(paste0(url, "masta-fpca-main.R"))
source(paste0(url, "masta-fpca-ppic.R"))
source(paste0(url, "masta-fpca-pred.R"))
source("R/GetPK.R")
source("R/IFPCA.R")
```

``` r
i <- 3 # 1, 2, 3 
```

``` r
# time for each code (training + validation)
time_code <- readr::read_csv(paste0("data-raw/time_code", i, ".csv"))
```

    ## Parsed with column specification:
    ## cols(
    ##   id = col_double(),
    ##   month = col_double()
    ## )

``` r
time <- time_code$month
names(time) <- time_code$id
str(time)
```

    ##  Named num [1:21501] 37 37 38 38 39 39 40 40 41 41 ...
    ##  - attr(*, "names")= chr [1:21501] "6" "6" "6" "6" ...

``` r
# follow up time for training and validation sets
follow_up_train <- readr::read_csv("data-raw/follow_up_train.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   id = col_double(),
    ##   fu_time = col_double()
    ## )

``` r
follow_up_valid <- readr::read_csv("data-raw/follow_up_valid.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   id = col_double(),
    ##   fu_time = col_double()
    ## )

``` r
fu_train <- follow_up_train$fu_time
fu_valid <- follow_up_valid$fu_time
names(fu_train) <- follow_up_train$id
names(fu_valid) <- follow_up_valid$id
str(fu_train)
```

    ##  Named num [1:20600] 49.4 13.9 12.6 14.9 80.7 ...
    ##  - attr(*, "names")= chr [1:20600] "1" "2" "3" "4" ...

``` r
str(fu_valid)
```

    ##  Named num [1:500] 71.7 70.4 14.9 33.8 98.6 ...
    ##  - attr(*, "names")= chr [1:500] "90001" "90002" "90003" "90004" ...

``` r
system.time(NEW <- ifpca(time, fu_train, fu_valid))
```

    ##    user  system elapsed 
    ##  11.601   1.035   8.296

``` r
str(NEW)
```

    ## List of 7
    ##  $ TrainFt: num [1:20600, 1:5] 49.4 13.9 12.6 14.9 80.7 ...
    ##   ..- attr(*, "dimnames")=List of 2
    ##   .. ..$ : chr [1:20600] "1" "2" "3" "4" ...
    ##   .. ..$ : chr [1:5] "1stCode" "Pk" "ChP" "1stScore" ...
    ##  $ TrainSc: num [1:20600, 1:6] 49.4 13.9 12.6 14.9 80.7 ...
    ##   ..- attr(*, "dimnames")=List of 2
    ##   .. ..$ : chr [1:20600] "1" "2" "3" "4" ...
    ##   .. ..$ : chr [1:6] "1stCode" "1stScore" "2ndScore" "3rdScore" ...
    ##  $ ValidFt: num [1:500, 1:5] 71.7 70.4 14.9 33.8 98.6 ...
    ##   ..- attr(*, "dimnames")=List of 2
    ##   .. ..$ : chr [1:500] "90001" "90002" "90003" "90004" ...
    ##   .. ..$ : chr [1:5] "1stCode" "Pk" "ChP" "1stScore" ...
    ##  $ ValidSc: num [1:500, 1:6] 71.7 70.4 14.9 33.8 98.6 ...
    ##   ..- attr(*, "dimnames")=List of 2
    ##   .. ..$ : chr [1:500] "90001" "90002" "90003" "90004" ...
    ##   .. ..$ : chr [1:6] "1stCode" "1stScore" "2ndScore" "3rdScore" ...
    ##  $ TrainPK: Named int [1:20600] NA NA NA NA NA 37 NA NA NA NA ...
    ##   ..- attr(*, "names")= chr [1:20600] "1" "2" "3" "4" ...
    ##  $ ValidPK: Named int [1:90487] NA NA NA NA NA NA NA NA NA NA ...
    ##   ..- attr(*, "names")= chr [1:90487] "90001" "90002" "90003" "90004" ...
    ##  $ FPCA   :List of 8
    ##   ..$ K        : int 3
    ##   ..$ scores   :'data.frame':    5998 obs. of  11 variables:
    ##   .. ..$ id      : chr [1:5998] "1" "2" "3" "4" ...
    ##   .. ..$ score_1 : num [1:5998] 0.0863 1.7192 -2.6026 1.3053 -1.4638 ...
    ##   .. ..$ score_2 : num [1:5998] 0.999 -0.154 -2.317 1.686 -0.569 ...
    ##   .. ..$ score_3 : num [1:5998] -0.188338 0.000578 0.747628 -0.439457 0.293587 ...
    ##   .. ..$ score_4 : num [1:5998] -1.046 1.302 0.801 -0.197 -0.451 ...
    ##   .. ..$ score_5 : num [1:5998] 0.3414 1.2492 -0.589 -0.2272 -0.0544 ...
    ##   .. ..$ score_6 : num [1:5998] -0.104 -0.69 0.641 0.406 -0.665 ...
    ##   .. ..$ score_7 : num [1:5998] -0.0857 0.3014 2.6718 0.9248 -2.414 ...
    ##   .. ..$ score_8 : num [1:5998] -0.1933 -0.0408 -1.3456 0.4373 1.2886 ...
    ##   .. ..$ score_9 : num [1:5998] 0.161 0.236 0.418 -0.394 -0.439 ...
    ##   .. ..$ score_10: num [1:5998] 0.0799 0.2574 0.2118 -0.1484 -0.1655 ...
    ##   ..$ dens     :'data.frame':    401 obs. of  5999 variables:
    ##   .. ..$ x    : num [1:401] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. ..$ f1   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f2   : num [1:401] 0.0452 0.0517 0.0588 0.0664 0.0745 ...
    ##   .. ..$ f3   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f4   : num [1:401] 0.0053 0.00593 0.00658 0.00723 0.00785 ...
    ##   .. ..$ f5   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f6   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f7   : num [1:401] 0.0193 0.022 0.0249 0.028 0.0312 ...
    ##   .. ..$ f8   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f9   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f10  : num [1:401] 1.29e-04 1.77e-05 0.00 0.00 0.00 ...
    ##   .. ..$ f11  : num [1:401] 0.0284 0.0324 0.0367 0.0414 0.0463 ...
    ##   .. ..$ f12  : num [1:401] 0.00497 0.00553 0.00609 0.00662 0.00712 ...
    ##   .. ..$ f13  : num [1:401] 0.128 0.147 0.168 0.19 0.214 ...
    ##   .. ..$ f14  : num [1:401] 0.217 0.25 0.286 0.325 0.368 ...
    ##   .. ..$ f15  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f16  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f17  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f18  : num [1:401] 0.00657 0.00737 0.00819 0.00902 0.00982 ...
    ##   .. ..$ f19  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f20  : num [1:401] 0.0102 0.0115 0.0129 0.0144 0.0159 ...
    ##   .. ..$ f21  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f22  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f23  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f24  : num [1:401] 0.00255 0.00277 0.00296 0.00311 0.00319 ...
    ##   .. ..$ f25  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f26  : num [1:401] 0.00592 0.00663 0.00735 0.00806 0.00875 ...
    ##   .. ..$ f27  : num [1:401] 0.00592 0.00661 0.00732 0.00802 0.00869 ...
    ##   .. ..$ f28  : num [1:401] 0.0145 0.0164 0.0186 0.0208 0.0231 ...
    ##   .. ..$ f29  : num [1:401] 0.0156 0.0177 0.02 0.0225 0.025 ...
    ##   .. ..$ f30  : num [1:401] 1.28e-04 9.11e-06 0.00 0.00 0.00 ...
    ##   .. ..$ f31  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f32  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f33  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f34  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f35  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f36  : num [1:401] 0.0111 0.0125 0.0141 0.0158 0.0175 ...
    ##   .. ..$ f37  : num [1:401] 0.0987 0.1135 0.1297 0.1474 0.1667 ...
    ##   .. ..$ f38  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f39  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f40  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f41  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f42  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f43  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f44  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f45  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f46  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f47  : num [1:401] 0.304 0.35 0.401 0.457 0.517 ...
    ##   .. ..$ f48  : num [1:401] 0.0119 0.0135 0.0152 0.0169 0.0188 ...
    ##   .. ..$ f49  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f50  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f51  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f52  : num [1:401] 0.313 0.361 0.413 0.47 0.532 ...
    ##   .. ..$ f53  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f54  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f55  : num [1:401] 0.00173 0.00184 0.00191 0.00192 0.00186 ...
    ##   .. ..$ f56  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f57  : num [1:401] 0.0117 0.0133 0.0149 0.0167 0.0185 ...
    ##   .. ..$ f58  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f59  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f60  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f61  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f62  : num [1:401] 0.00147 0.00154 0.00158 0.00156 0.00147 ...
    ##   .. ..$ f63  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f64  : num [1:401] 0.000845 0.0009 0.000938 0.000951 0.00093 ...
    ##   .. ..$ f65  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f66  : num [1:401] 0.000449 0.000448 0.000425 0.000372 0.00028 ...
    ##   .. ..$ f67  : num [1:401] 0 0 0 0 0 ...
    ##   .. ..$ f68  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f69  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f70  : num [1:401] 0.136 0.156 0.177 0.201 0.227 ...
    ##   .. ..$ f71  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f72  : num [1:401] 0.0108 0.0124 0.0141 0.016 0.018 ...
    ##   .. ..$ f73  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f74  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f75  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f76  : num [1:401] 0.0389 0.0445 0.0506 0.0571 0.0641 ...
    ##   .. ..$ f77  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f78  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f79  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f80  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f81  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f82  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f83  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f84  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f85  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f86  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f87  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f88  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f89  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f90  : num [1:401] 0.00187 0.0021 0.00235 0.0026 0.00285 ...
    ##   .. ..$ f91  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f92  : num [1:401] 5.72e-06 0.00 0.00 0.00 0.00 ...
    ##   .. ..$ f93  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f94  : num [1:401] 0.0561 0.0641 0.0729 0.0823 0.0924 ...
    ##   .. ..$ f95  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f96  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f97  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ f98  : num [1:401] 0.00161 0.00231 0.00323 0.00441 0.00592 ...
    ##   .. .. [list output truncated]
    ##   ..$ deriv    :'data.frame':    399 obs. of  5999 variables:
    ##   .. ..$ dx    : num [1:399] 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 0.025 ...
    ##   .. ..$ df1   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df2   : num [1:399] 2.71 2.94 3.16 3.36 3.54 ...
    ##   .. ..$ df3   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df4   : num [1:399] 0.256 0.258 0.253 0.239 0.214 ...
    ##   .. ..$ df5   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df6   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df7   : num [1:399] 1.12 1.2 1.27 1.33 1.38 ...
    ##   .. ..$ df8   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df9   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df10  : num [1:399] -0.0258 -0.00355 0 0 0 ...
    ##   .. ..$ df11  : num [1:399] 1.67 1.8 1.92 2.03 2.11 ...
    ##   .. ..$ df12  : num [1:399] 0.223 0.219 0.207 0.184 0.149 ...
    ##   .. ..$ df13  : num [1:399] 7.88 8.59 9.3 9.97 10.62 ...
    ##   .. ..$ df14  : num [1:399] 13.7 15.1 16.5 17.8 19.2 ...
    ##   .. ..$ df15  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df16  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df17  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df18  : num [1:399] 0.324 0.329 0.327 0.313 0.288 ...
    ##   .. ..$ df19  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df20  : num [1:399] 0.548 0.575 0.593 0.601 0.596 ...
    ##   .. ..$ df21  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df22  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df23  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df24  : num [1:399] 0.082 0.0672 0.0446 0.013 -0.0288 ...
    ##   .. ..$ df25  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df26  : num [1:399] 0.285 0.287 0.281 0.265 0.237 ...
    ##   .. ..$ df27  : num [1:399] 0.281 0.282 0.274 0.255 0.224 ...
    ##   .. ..$ df28  : num [1:399] 0.813 0.864 0.906 0.937 0.954 ...
    ##   .. ..$ df29  : num [1:399] 0.887 0.946 0.997 1.037 1.064 ...
    ##   .. ..$ df30  : num [1:399] -0.02558 -0.00182 0 0 0 ...
    ##   .. ..$ df31  : num [1:399] 0 0 0 0 0 ...
    ##   .. ..$ df32  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df33  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df34  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df35  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df36  : num [1:399] 0.611 0.646 0.673 0.69 0.695 ...
    ##   .. ..$ df37  : num [1:399] 6.19 6.79 7.39 7.99 8.57 ...
    ##   .. ..$ df38  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df39  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df40  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df41  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df42  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df43  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df44  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df45  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df46  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df47  : num [1:399] 19.3 21.2 23.2 25.2 27.1 ...
    ##   .. ..$ df48  : num [1:399] 0.659 0.697 0.728 0.748 0.756 ...
    ##   .. ..$ df49  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df50  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df51  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df52  : num [1:399] 19.9 21.9 23.9 26 28 ...
    ##   .. ..$ df53  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df54  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df55  : num [1:399] 0.03432 0.01599 -0.00975 -0.04413 -0.08814 ...
    ##   .. ..$ df56  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df57  : num [1:399] 0.648 0.685 0.715 0.733 0.74 ...
    ##   .. ..$ df58  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df59  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df60  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df61  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df62  : num [1:399] 0.02156 0.00307 -0.02247 -0.05623 -0.09913 ...
    ##   .. ..$ df63  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df64  : num [1:399] 0.01861 0.0102 -0.00175 -0.01785 -0.03855 ...
    ##   .. ..$ df65  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df66  : num [1:399] -0.00492 -0.01522 -0.02895 -0.04666 -0.05596 ...
    ##   .. ..$ df67  : num [1:399] 0 0 0 0.00292 0.04191 ...
    ##   .. ..$ df68  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df69  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df70  : num [1:399] 8.38 9.15 9.91 10.66 11.37 ...
    ##   .. ..$ df71  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df72  : num [1:399] 0.658 0.715 0.77 0.822 0.87 ...
    ##   .. ..$ df73  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df74  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df75  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df76  : num [1:399] 2.33 2.52 2.71 2.87 3.02 ...
    ##   .. ..$ df77  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df78  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df79  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df80  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df81  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df82  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df83  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df84  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df85  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df86  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df87  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df88  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df89  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df90  : num [1:399] 0.0964 0.0994 0.1003 0.0985 0.0936 ...
    ##   .. ..$ df91  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df92  : num [1:399] -0.00114 0 0 0 0 ...
    ##   .. ..$ df93  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df94  : num [1:399] 3.36 3.63 3.9 4.14 4.36 ...
    ##   .. ..$ df95  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df96  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df97  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. ..$ df98  : num [1:399] 0.325 0.42 0.537 0.679 0.848 ...
    ##   .. .. [list output truncated]
    ##   ..$ mean     :'data.frame':    401 obs. of  2 variables:
    ##   .. ..$ x   : num [1:401] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. ..$ f_mu: num [1:401] 0.00138 0.0018 0.00233 0.00299 0.00381 ...
    ##   ..$ basis    :'data.frame':    401 obs. of  11 variables:
    ##   .. ..$ x       : num [1:401] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. ..$ basis_1 : num [1:401] 0.000941 0.00091 0.000823 0.000664 0.000409 ...
    ##   .. ..$ basis_2 : num [1:401] -0.0403 -0.0465 -0.0534 -0.061 -0.0693 ...
    ##   .. ..$ basis_3 : num [1:401] -0.163 -0.188 -0.215 -0.245 -0.277 ...
    ##   .. ..$ basis_4 : num [1:401] -0.0107 -0.0122 -0.0139 -0.0156 -0.0175 ...
    ##   .. ..$ basis_5 : num [1:401] -0.0126 -0.0144 -0.0165 -0.0187 -0.0211 ...
    ##   .. ..$ basis_6 : num [1:401] -0.0249 -0.0283 -0.0321 -0.0362 -0.0405 ...
    ##   .. ..$ basis_7 : num [1:401] -0.0085 -0.00943 -0.01034 -0.01119 -0.01194 ...
    ##   .. ..$ basis_8 : num [1:401] 0.008 0.00879 0.00955 0.01023 0.01081 ...
    ##   .. ..$ basis_9 : num [1:401] -0.0481 -0.0547 -0.0618 -0.0695 -0.0777 ...
    ##   .. ..$ basis_10: num [1:401] 0.11 0.125 0.141 0.158 0.176 ...
    ##   ..$ baseline : num [1:10] -1.8945 0.4612 -0.1163 -0.102 0.0197 ...
    ##   ..$ ValidPred:List of 4
    ##   .. ..$ scores     : num [1:83, 1:10] 0.151 1.61 0.693 1.066 1.703 ...
    ##   .. .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. .. ..$ : chr [1:83] "90003" "90010" "90027" "90032" ...
    ##   .. .. .. ..$ : chr [1:10] "basis_1" "basis_2" "basis_3" "basis_4" ...
    ##   .. ..$ densities  : num [1:401, 1:84] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. .. ..$ : NULL
    ##   .. .. .. ..$ : chr [1:84] "" "90003" "90010" "90027" ...
    ##   .. ..$ derivatives: num [1:399, 1:84] 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 0.025 ...
    ##   .. .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. .. ..$ : NULL
    ##   .. .. .. ..$ : chr [1:84] "" "90003" "90010" "90027" ...
    ##   .. ..$ baseline   : num [1:10] -1.8945 0.4612 -0.1163 -0.102 0.0197 ...

## Old Implementation

``` r
library(MASTA) 
```

    ## Loading required package: survival

    ## 
    ## Attaching package: 'MASTA'

    ## The following object is masked _by_ '.GlobalEnv':
    ## 
    ##     FPC.Kern.S

``` r
system.time(OLD <- masta.fpca(data_org))
```

    ## [1] "training: pred1"
    ## [1] "training: pred2"
    ## [1] "training: pred3"
    ## [1] "validation: pred1"
    ## [1] "validation: pred2"
    ## [1] "validation: pred3"

    ##    user  system elapsed 
    ## 108.343   9.123  76.938

``` r
str(OLD)
```

    ## List of 16
    ##  $ nn                : int 600
    ##  $ codes             : chr [1:3] "pred1" "pred2" "pred3"
    ##  $ Tend              : num 1
    ##  $ TrainSurv         :'data.frame':  600 obs. of  7 variables:
    ##   ..$ case      : int [1:600] 1 2 3 4 5 6 7 8 9 10 ...
    ##   ..$ delta     : int [1:600] 1 0 0 0 0 1 0 0 0 0 ...
    ##   ..$ sx        : num [1:600] 9.36 13.93 12.55 14.85 80.66 ...
    ##   ..$ sc        : num [1:600] 49.4 13.9 12.6 14.9 80.7 ...
    ##   ..$ base_pred1: int [1:600] 79 81 55 72 83 47 86 40 85 58 ...
    ##   ..$ base_pred2: int [1:600] 1 0 1 1 1 1 0 0 1 0 ...
    ##   ..$ base_pred3: int [1:600] 0 0 1 0 1 0 1 0 0 1 ...
    ##  $ ValidSurv         :'data.frame':  500 obs. of  7 variables:
    ##   ..$ case      : int [1:500] 90001 90002 90003 90004 90005 90006 90007 90008 90009 90010 ...
    ##   ..$ delta     : int [1:500] 0 0 1 1 0 0 0 0 0 0 ...
    ##   ..$ sx        : num [1:500] 71.72 70.37 9.49 17.77 98.63 ...
    ##   ..$ sc        : num [1:500] 71.7 70.4 14.9 33.8 98.6 ...
    ##   ..$ base_pred1: int [1:500] 39 36 68 59 38 53 88 60 40 33 ...
    ##   ..$ base_pred2: int [1:500] 1 0 1 0 1 0 0 1 0 0 ...
    ##   ..$ base_pred3: int [1:500] 0 1 1 0 0 0 1 0 0 0 ...
    ##  $ TrainSurv_pred_org:'data.frame':  600 obs. of  3 variables:
    ##   ..$ base_pred1: int [1:600] 79 81 55 72 83 47 86 40 85 58 ...
    ##   ..$ base_pred2: int [1:600] 1 0 1 1 1 1 0 0 1 0 ...
    ##   ..$ base_pred3: int [1:600] 0 0 1 0 1 0 1 0 0 1 ...
    ##  $ ValidSurv_pred_org:'data.frame':  500 obs. of  3 variables:
    ##   ..$ base_pred1: int [1:500] 39 36 68 59 38 53 88 60 40 33 ...
    ##   ..$ base_pred2: int [1:500] 1 0 1 0 1 0 0 1 0 0 ...
    ##   ..$ base_pred3: int [1:500] 0 1 1 0 0 0 1 0 0 0 ...
    ##  $ TrainN            :'data.frame':  20600 obs. of  4 variables:
    ##   ..$ case       : Factor w/ 20600 levels "1","10","100",..: 1 11112 12824 13935 15046 16157 17268 18379 19490 2 ...
    ##   ..$ pred1_total: int [1:20600] 0 0 0 4 24 14 0 0 6 0 ...
    ##   ..$ pred2_total: int [1:20600] 1 0 0 0 3 7 0 0 0 0 ...
    ##   ..$ pred3_total: int [1:20600] 0 0 0 0 0 11 0 0 0 0 ...
    ##  $ ValidN            :'data.frame':  500 obs. of  4 variables:
    ##   ..$ case       : Factor w/ 500 levels "90001","90002",..: 1 2 3 4 5 6 7 8 9 10 ...
    ##   ..$ pred1_total: int [1:500] 3 0 14 0 0 3 0 0 21 4 ...
    ##   ..$ pred2_total: int [1:500] 1 2 3 0 4 0 0 0 1 0 ...
    ##   ..$ pred3_total: int [1:500] 0 0 1 0 0 0 0 0 0 1 ...
    ##  $ TrainFt           : num [1:600, 1:15] 49.4 13.9 12.6 1 4 ...
    ##   ..- attr(*, "dimnames")=List of 2
    ##   .. ..$ : chr [1:600] "1" "2" "3" "4" ...
    ##   .. ..$ : chr [1:15] "1stCode1" "Pk1" "ChP1" "1stScore1" ...
    ##  $ ValidFt           : num [1:500, 1:15] 9 70.4 5 33.8 98.6 ...
    ##   ..- attr(*, "dimnames")=List of 2
    ##   .. ..$ : chr [1:500] "90001" "90002" "90003" "90004" ...
    ##   .. ..$ : chr [1:15] "1stCode1" "Pk1" "ChP1" "1stScore1" ...
    ##  $ TrainPK           : int [1:600, 1:3] NA NA NA 1 4 19 NA NA 2 NA ...
    ##   ..- attr(*, "dimnames")=List of 2
    ##   .. ..$ : chr [1:600] "1" "2" "3" "4" ...
    ##   .. ..$ : chr [1:3] "pred1" "pred2" "pred3"
    ##  $ ValidPK           : int [1:500, 1:3] 9 NA 5 NA NA 1 NA NA 1 2 ...
    ##   ..- attr(*, "dimnames")=List of 2
    ##   .. ..$ : chr [1:500] "90001" "90002" "90003" "90004" ...
    ##   .. ..$ : chr [1:3] "pred1" "pred2" "pred3"
    ##  $ TrainSc           : num [1:600, 1:18] 49.4 13.9 12.6 1 4 ...
    ##   ..- attr(*, "dimnames")=List of 2
    ##   .. ..$ : chr [1:600] "1" "2" "3" "4" ...
    ##   .. ..$ : chr [1:18] "1stCode1" "1stScore1" "2ndScore1" "3rdScore1" ...
    ##  $ ValidSc           : num [1:500, 1:18] 9 70.4 5 33.8 98.6 ...
    ##   ..- attr(*, "dimnames")=List of 2
    ##   .. ..$ : chr [1:500] "90001" "90002" "90003" "90004" ...
    ##   .. ..$ : chr [1:18] "1stCode1" "1stScore1" "2ndScore1" "3rdScore1" ...
    ##  $ FPCA              :List of 3
    ##   ..$ pred1:List of 8
    ##   .. ..$ K        : int 5
    ##   .. ..$ scores   :'data.frame': 12250 obs. of  11 variables:
    ##   .. .. ..$ id      : chr [1:12250] "1" "2" "3" "4" ...
    ##   .. .. ..$ score_1 : num [1:12250] -1.543 -1.339 0.891 0.982 -0.313 ...
    ##   .. .. ..$ score_2 : num [1:12250] -0.802 -0.508 0.184 -0.051 1.386 ...
    ##   .. .. ..$ score_3 : num [1:12250] -1.437 -1.183 0.412 0.437 0.163 ...
    ##   .. .. ..$ score_4 : num [1:12250] -0.812 -0.608 -0.367 -0.215 1.245 ...
    ##   .. .. ..$ score_5 : num [1:12250] -0.0924 -0.1942 -0.094 0.167 0.0522 ...
    ##   .. .. ..$ score_6 : num [1:12250] -0.103 -0.296 -0.105 -0.42 -0.893 ...
    ##   .. .. ..$ score_7 : num [1:12250] -0.0693 0.0674 -0.2096 -0.4585 1.3206 ...
    ##   .. .. ..$ score_8 : num [1:12250] 0.3946 0.2594 0.0207 -0.3862 -1.1157 ...
    ##   .. .. ..$ score_9 : num [1:12250] -1.0121 -0.7398 -0.0977 -0.1556 -0.3136 ...
    ##   .. .. ..$ score_10: num [1:12250] 0.7403 0.6834 0.0876 0.3918 -0.1903 ...
    ##   .. ..$ dens     :'data.frame': 401 obs. of  12251 variables:
    ##   .. .. ..$ x     : num [1:401] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. .. ..$ f1    : num [1:401] 1.71 2.07 2.44 2.83 3.22 ...
    ##   .. .. ..$ f2    : num [1:401] 1.51 1.83 2.16 2.5 2.85 ...
    ##   .. .. ..$ f3    : num [1:401] 0.597 0.559 0.517 0.471 0.423 ...
    ##   .. .. ..$ f4    : num [1:401] 0.467 0.409 0.347 0.282 0.213 ...
    ##   .. .. ..$ f5    : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f6    : num [1:401] 2.7 2.97 3.24 3.52 3.81 ...
    ##   .. .. ..$ f7    : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f8    : num [1:401] 0.973 0.921 0.862 0.799 0.732 ...
    ##   .. .. ..$ f9    : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f10   : num [1:401] 3.43 3.79 4.17 4.55 4.93 ...
    ##   .. .. ..$ f11   : num [1:401] 0 0 0 0 0 ...
    ##   .. .. ..$ f12   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f13   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f14   : num [1:401] 0.555 0.506 0.454 0.398 0.339 ...
    ##   .. .. ..$ f15   : num [1:401] 1.14 1.12 1.1 1.08 1.05 ...
    ##   .. .. ..$ f16   : num [1:401] 1.17 1.32 1.48 1.63 1.79 ...
    ##   .. .. ..$ f17   : num [1:401] 0.395 0.52 0.651 0.786 0.925 ...
    ##   .. .. ..$ f18   : num [1:401] 1.67 1.95 2.24 2.54 2.85 ...
    ##   .. .. ..$ f19   : num [1:401] 0.0163 0.0196 0.0245 0.0311 0.0398 ...
    ##   .. .. ..$ f20   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f21   : num [1:401] 0.418 0.382 0.343 0.302 0.258 ...
    ##   .. .. ..$ f22   : num [1:401] 0 0 0 0 0 ...
    ##   .. .. ..$ f23   : num [1:401] 1.45 1.68 1.93 2.18 2.44 ...
    ##   .. .. ..$ f24   : num [1:401] 0.1027 0.0797 0.0551 0.0292 0.0024 ...
    ##   .. .. ..$ f25   : num [1:401] 0.393 0.349 0.303 0.256 0.209 ...
    ##   .. .. ..$ f26   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f27   : num [1:401] 0.911 1.107 1.313 1.525 1.741 ...
    ##   .. .. ..$ f28   : num [1:401] 0.618 0.648 0.678 0.706 0.733 ...
    ##   .. .. ..$ f29   : num [1:401] 0.792 1.041 1.302 1.573 1.85 ...
    ##   .. .. ..$ f30   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f31   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f32   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f33   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f34   : num [1:401] 0.269 0.322 0.378 0.438 0.5 ...
    ##   .. .. ..$ f35   : num [1:401] 4.77 5.09 5.41 5.73 6.05 ...
    ##   .. .. ..$ f36   : num [1:401] 0.518 0.475 0.429 0.381 0.331 ...
    ##   .. .. ..$ f37   : num [1:401] 0.2693 0.2296 0.1871 0.1422 0.0955 ...
    ##   .. .. ..$ f38   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f39   : num [1:401] 1.57 1.86 2.16 2.48 2.8 ...
    ##   .. .. ..$ f40   : num [1:401] 0.36 0.499 0.644 0.796 0.951 ...
    ##   .. .. ..$ f41   : num [1:401] 1.103 1.041 0.973 0.9 0.821 ...
    ##   .. .. ..$ f42   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f43   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f44   : num [1:401] 0.0753 0.0453 0.0136 0 0 ...
    ##   .. .. ..$ f45   : num [1:401] 0.1224 0.0815 0.0394 0 0 ...
    ##   .. .. ..$ f46   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f47   : num [1:401] 0.482 0.487 0.49 0.491 0.492 ...
    ##   .. .. ..$ f48   : num [1:401] 0.8 0.731 0.656 0.576 0.493 ...
    ##   .. .. ..$ f49   : num [1:401] 0.346 0.385 0.425 0.467 0.511 ...
    ##   .. .. ..$ f50   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f51   : num [1:401] 0.0928 0.0834 0.0731 0.062 0.0503 ...
    ##   .. .. ..$ f52   : num [1:401] 2.73 3.1 3.48 3.88 4.28 ...
    ##   .. .. ..$ f53   : num [1:401] 3.29 3.65 4.03 4.42 4.81 ...
    ##   .. .. ..$ f54   : num [1:401] 0.388 0.38 0.371 0.361 0.351 ...
    ##   .. .. ..$ f55   : num [1:401] 0 0 0 0 0 ...
    ##   .. .. ..$ f56   : num [1:401] 0.874 1.059 1.252 1.451 1.655 ...
    ##   .. .. ..$ f57   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f58   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f59   : num [1:401] 0.894 0.848 0.796 0.74 0.681 ...
    ##   .. .. ..$ f60   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f61   : num [1:401] 0.363 0.429 0.498 0.57 0.644 ...
    ##   .. .. ..$ f62   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f63   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f64   : num [1:401] 0.586 0.602 0.617 0.632 0.647 ...
    ##   .. .. ..$ f65   : num [1:401] 0.2478 0.2129 0.1753 0.1357 0.0944 ...
    ##   .. .. ..$ f66   : num [1:401] 2.48 2.85 3.24 3.64 4.05 ...
    ##   .. .. ..$ f67   : num [1:401] 0.702 0.716 0.729 0.739 0.748 ...
    ##   .. .. ..$ f68   : num [1:401] 1.025 0.963 0.896 0.823 0.746 ...
    ##   .. .. ..$ f69   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f70   : num [1:401] 0.313 0.328 0.343 0.358 0.373 ...
    ##   .. .. ..$ f71   : num [1:401] 0.927 0.93 0.93 0.926 0.92 ...
    ##   .. .. ..$ f72   : num [1:401] 0.687 0.79 0.899 1.011 1.127 ...
    ##   .. .. ..$ f73   : num [1:401] 0.474 0.515 0.558 0.603 0.65 ...
    ##   .. .. ..$ f74   : num [1:401] 0.365 0.317 0.266 0.212 0.157 ...
    ##   .. .. ..$ f75   : num [1:401] 0 0.0101 0.1365 0.2681 0.4035 ...
    ##   .. .. ..$ f76   : num [1:401] 0 0 0 0 0 ...
    ##   .. .. ..$ f77   : num [1:401] 0.419 0.363 0.302 0.239 0.172 ...
    ##   .. .. ..$ f78   : num [1:401] 0.617 0.575 0.528 0.478 0.425 ...
    ##   .. .. ..$ f79   : num [1:401] 0.542 0.641 0.743 0.849 0.956 ...
    ##   .. .. ..$ f80   : num [1:401] 1.67 2.06 2.47 2.89 3.32 ...
    ##   .. .. ..$ f81   : num [1:401] 1.18 1.15 1.12 1.08 1.04 ...
    ##   .. .. ..$ f82   : num [1:401] 1.45 1.58 1.72 1.86 2 ...
    ##   .. .. ..$ f83   : num [1:401] 0.922 0.886 0.845 0.799 0.751 ...
    ##   .. .. ..$ f84   : num [1:401] 1.19 1.15 1.11 1.07 1.02 ...
    ##   .. .. ..$ f85   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f86   : num [1:401] 0.3096 0.2271 0.1394 0.0478 0 ...
    ##   .. .. ..$ f87   : num [1:401] 1.98 2.35 2.73 3.12 3.52 ...
    ##   .. .. ..$ f88   : num [1:401] 1.63 1.96 2.32 2.68 3.05 ...
    ##   .. .. ..$ f89   : num [1:401] 0.861 0.865 0.867 0.866 0.863 ...
    ##   .. .. ..$ f90   : num [1:401] 1.52 1.88 2.26 2.66 3.06 ...
    ##   .. .. ..$ f91   : num [1:401] 0.0773 0.0325 0 0 0 ...
    ##   .. .. ..$ f92   : num [1:401] 0.483 0.545 0.61 0.679 0.751 ...
    ##   .. .. ..$ f93   : num [1:401] 1.09 1.08 1.06 1.05 1.03 ...
    ##   .. .. ..$ f94   : num [1:401] 2.23 2.62 3.02 3.43 3.86 ...
    ##   .. .. ..$ f95   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f96   : num [1:401] 0.624 0.762 0.906 1.054 1.205 ...
    ##   .. .. ..$ f97   : num [1:401] 0.71 0.709 0.704 0.697 0.688 ...
    ##   .. .. ..$ f98   : num [1:401] 1.34 1.57 1.8 2.05 2.3 ...
    ##   .. .. .. [list output truncated]
    ##   .. ..$ deriv    :'data.frame': 399 obs. of  12251 variables:
    ##   .. .. ..$ dx     : num [1:399] 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 0.025 ...
    ##   .. .. ..$ df1    : num [1:399] 146 152 156 159 161 ...
    ##   .. .. ..$ df2    : num [1:399] 130 135 139 141 143 ...
    ##   .. .. ..$ df3    : num [1:399] -16.1 -17.5 -18.7 -19.7 -20.4 ...
    ##   .. .. ..$ df4    : num [1:399] -23.9 -25.5 -26.9 -27.9 -28.5 ...
    ##   .. .. ..$ df5    : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df6    : num [1:399] 109 111 113 113 113 ...
    ##   .. .. ..$ df7    : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df8    : num [1:399] -22.2 -24.3 -26.1 -27.5 -28.5 ...
    ##   .. .. ..$ df9    : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df10   : num [1:399] 148 151 154 155 154 ...
    ##   .. .. ..$ df11   : num [1:399] 0 0 0 0 0 ...
    ##   .. .. ..$ df12   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df13   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df14   : num [1:399] -20.1 -21.7 -22.9 -23.9 -24.5 ...
    ##   .. .. ..$ df15   : num [1:399] -7.19 -8.93 -10.55 -12.01 -13.31 ...
    ##   .. .. ..$ df16   : num [1:399] 60.3 62.1 63.3 64 64.1 ...
    ##   .. .. ..$ df17   : num [1:399] 51.1 53.2 54.9 56 56.5 ...
    ##   .. .. ..$ df18   : num [1:399] 114 118 121 124 125 ...
    ##   .. .. ..$ df19   : num [1:399] 1.63 2.29 3.08 4 5.07 ...
    ##   .. .. ..$ df20   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df21   : num [1:399] -14.9 -16 -17 -17.7 -18.2 ...
    ##   .. .. ..$ df22   : num [1:399] 0 0 0 0 0 ...
    ##   .. .. ..$ df23   : num [1:399] 96.5 100 102.6 104.3 105.1 ...
    ##   .. .. ..$ df24   : num [1:399] -9.518 -10.085 -10.538 -5.848 -0.481 ...
    ##   .. .. ..$ df25   : num [1:399] -18 -18.6 -18.7 -18.4 -17.7 ...
    ##   .. .. ..$ df26   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df27   : num [1:399] 80.3 83.4 85.8 87.3 88 ...
    ##   .. .. ..$ df28   : num [1:399] 11.91 11.58 11.11 10.49 9.71 ...
    ##   .. .. ..$ df29   : num [1:399] 102 106 110 112 113 ...
    ##   .. .. ..$ df30   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df31   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df32   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df33   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df34   : num [1:399] 21.8 23.2 24.5 25.7 26.8 ...
    ##   .. .. ..$ df35   : num [1:399] 126 128 128 128 126 ...
    ##   .. .. ..$ df36   : num [1:399] -17.6 -18.8 -19.8 -20.4 -20.7 ...
    ##   .. .. ..$ df37   : num [1:399] -16.4 -17.5 -18.3 -18.9 -19.1 ...
    ##   .. .. ..$ df38   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df39   : num [1:399] 119 123 127 129 130 ...
    ##   .. .. ..$ df40   : num [1:399] 56.8 59.4 61.4 62.8 63.6 ...
    ##   .. .. ..$ df41   : num [1:399] -26 -28.4 -30.4 -31.9 -32.9 ...
    ##   .. .. ..$ df42   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df43   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df44   : num [1:399] -12.34 -9.07 -2.73 0 0 ...
    ##   .. .. ..$ df45   : num [1:399] -16.59 -16.3 -7.89 0 0 ...
    ##   .. .. ..$ df46   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df47   : num [1:399] 1.49 0.921 0.343 -0.24 -0.825 ...
    ##   .. .. ..$ df48   : num [1:399] -28.7 -30.9 -32.5 -33.8 -34.5 ...
    ##   .. .. ..$ df49   : num [1:399] 15.8 16.5 17.1 17.6 18.1 ...
    ##   .. .. ..$ df50   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df51   : num [1:399] -3.94 -4.27 -4.57 -4.82 -5.02 ...
    ##   .. .. ..$ df52   : num [1:399] 152 156 160 162 162 ...
    ##   .. .. ..$ df53   : num [1:399] 149 153 156 157 156 ...
    ##   .. .. ..$ df54   : num [1:399] -3.36 -3.77 -4.08 -4.28 -4.34 ...
    ##   .. .. ..$ df55   : num [1:399] 0 0 0 0 0 ...
    ##   .. .. ..$ df56   : num [1:399] 75.5 78.5 80.6 82.1 82.6 ...
    ##   .. .. ..$ df57   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df58   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df59   : num [1:399] -19.5 -21.4 -23.1 -24.4 -25.3 ...
    ##   .. .. ..$ df60   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df61   : num [1:399] 27 28.2 29.2 30 30.6 ...
    ##   .. .. ..$ df62   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df63   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df64   : num [1:399] 6.3 6.12 5.96 5.81 5.69 ...
    ##   .. .. ..$ df65   : num [1:399] -14.5 -15.4 -16.2 -16.7 -17.1 ...
    ##   .. .. ..$ df66   : num [1:399] 152 157 161 163 163 ...
    ##   .. .. ..$ df67   : num [1:399] 5.4 4.65 3.82 2.93 1.96 ...
    ##   .. .. ..$ df68   : num [1:399] -25.8 -28 -29.9 -31.3 -32.2 ...
    ##   .. .. ..$ df69   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df70   : num [1:399] 6.1 6.06 5.98 5.86 5.69 ...
    ##   .. .. ..$ df71   : num [1:399] 0.566 -0.666 -1.898 -3.12 -4.324 ...
    ##   .. .. ..$ df72   : num [1:399] 42.4 44.2 45.6 46.7 47.5 ...
    ##   .. .. ..$ df73   : num [1:399] 16.8 17.6 18.3 19.1 19.8 ...
    ##   .. .. ..$ df74   : num [1:399] -19.8 -21 -21.9 -22.5 -22.7 ...
    ##   .. .. ..$ df75   : num [1:399] 27.3 51.6 53.4 54.6 55.1 ...
    ##   .. .. ..$ df76   : num [1:399] 0 0 0 0 3.44 ...
    ##   .. .. ..$ df77   : num [1:399] -23.3 -24.8 -26 -26.8 -27.3 ...
    ##   .. .. ..$ df78   : num [1:399] -17.8 -19.3 -20.6 -21.6 -22.4 ...
    ##   .. .. ..$ df79   : num [1:399] 40.3 41.6 42.5 43 43 ...
    ##   .. .. ..$ df80   : num [1:399] 159 165 170 173 174 ...
    ##   .. .. ..$ df81   : num [1:399] -11.9 -13.8 -15.6 -17.1 -18.4 ...
    ##   .. .. ..$ df82   : num [1:399] 53.8 55.2 56.1 56.7 56.8 ...
    ##   .. .. ..$ df83   : num [1:399] -15.5 -17.3 -18.9 -20.2 -21.2 ...
    ##   .. .. ..$ df84   : num [1:399] -14.3 -16.3 -18.1 -19.6 -20.9 ...
    ##   .. .. ..$ df85   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df86   : num [1:399] -34.03 -35.85 -27.89 -9.56 0 ...
    ##   .. .. ..$ df87   : num [1:399] 148 154 158 161 162 ...
    ##   .. .. ..$ df88   : num [1:399] 137 143 147 150 151 ...
    ##   .. .. ..$ df89   : num [1:399] 1.317 0.21 -0.906 -2.023 -3.134 ...
    ##   .. .. ..$ df90   : num [1:399] 149 155 159 162 164 ...
    ##   .. .. ..$ df91   : num [1:399] -15.5 -6.5 0 0 0 ...
    ##   .. .. ..$ df92   : num [1:399] 25.5 26.8 28.1 29.3 30.4 ...
    ##   .. .. ..$ df93   : num [1:399] -4.19 -5.78 -7.28 -8.69 -9.99 ...
    ##   .. .. ..$ df94   : num [1:399] 158 163 167 170 171 ...
    ##   .. .. ..$ df95   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df96   : num [1:399] 56.3 58.4 59.9 60.8 61 ...
    ##   .. .. ..$ df97   : num [1:399] -1.27 -2.3 -3.3 -4.27 -5.2 ...
    ##   .. .. ..$ df98   : num [1:399] 91.9 95.6 98.5 100.6 101.9 ...
    ##   .. .. .. [list output truncated]
    ##   .. ..$ mean     :'data.frame': 401 obs. of  2 variables:
    ##   .. .. ..$ x   : num [1:401] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. .. ..$ f_mu: num [1:401] 0.708 0.776 0.847 0.919 0.993 ...
    ##   .. ..$ basis    :'data.frame': 401 obs. of  11 variables:
    ##   .. .. ..$ x       : num [1:401] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. .. ..$ basis_1 : num [1:401] -0.699 -0.743 -0.788 -0.833 -0.879 ...
    ##   .. .. ..$ basis_2 : num [1:401] -0.466 -0.511 -0.557 -0.604 -0.651 ...
    ##   .. .. ..$ basis_3 : num [1:401] 0.517 0.3254 0.1213 -0.0932 -0.3159 ...
    ##   .. .. ..$ basis_4 : num [1:401] -1.08 -1.11 -1.15 -1.18 -1.21 ...
    ##   .. .. ..$ basis_5 : num [1:401] -0.127 -0.189 -0.254 -0.321 -0.388 ...
    ##   .. .. ..$ basis_6 : num [1:401] -0.879 -0.916 -0.952 -0.987 -1.019 ...
    ##   .. .. ..$ basis_7 : num [1:401] -0.909 -0.804 -0.691 -0.572 -0.449 ...
    ##   .. .. ..$ basis_8 : num [1:401] -2.22 -2.19 -2.14 -2.09 -2.02 ...
    ##   .. .. ..$ basis_9 : num [1:401] 6.37 5.99 5.57 5.11 4.63 ...
    ##   .. .. ..$ basis_10: num [1:401] -3.02 -2.95 -2.85 -2.74 -2.62 ...
    ##   .. ..$ baseline : num [1:10] 0.14527 0.17727 -0.97105 -0.00576 0.17865 ...
    ##   .. ..$ ValidPred:List of 4
    ##   .. .. ..$ scores     : num [1:273, 1:10] 0.398 0.686 -1.322 0.269 0.378 ...
    ##   .. .. .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. .. .. ..$ : chr [1:273] "90001" "90003" "90006" "90009" ...
    ##   .. .. .. .. ..$ : chr [1:10] "basis_1" "basis_2" "basis_3" "basis_4" ...
    ##   .. .. ..$ densities  : num [1:401, 1:274] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. .. .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. .. .. ..$ : NULL
    ##   .. .. .. .. ..$ : chr [1:274] "" "90001" "90003" "90006" ...
    ##   .. .. ..$ derivatives: num [1:399, 1:274] 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 0.025 ...
    ##   .. .. .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. .. .. ..$ : NULL
    ##   .. .. .. .. ..$ : chr [1:274] "" "90001" "90003" "90006" ...
    ##   .. .. ..$ baseline   : num [1:10] 0.14527 0.17727 -0.97105 -0.00576 0.17865 ...
    ##   ..$ pred2:List of 8
    ##   .. ..$ K        : int 4
    ##   .. ..$ scores   :'data.frame': 15808 obs. of  11 variables:
    ##   .. .. ..$ id      : chr [1:15808] "1" "2" "3" "4" ...
    ##   .. .. ..$ score_1 : num [1:15808] -0.33383 -0.00218 -0.24757 -0.44431 -0.042 ...
    ##   .. .. ..$ score_2 : num [1:15808] -0.211 0.243 -0.473 -0.657 -0.271 ...
    ##   .. .. ..$ score_3 : num [1:15808] -1.288 -1.24 -0.128 -0.568 -0.296 ...
    ##   .. .. ..$ score_4 : num [1:15808] 1.032 -0.572 -0.51 -0.189 -0.56 ...
    ##   .. .. ..$ score_5 : num [1:15808] -0.1546 -1.2381 0.0507 0.5897 -0.0424 ...
    ##   .. .. ..$ score_6 : num [1:15808] 0.599 -0.436 -0.343 -0.088 0.249 ...
    ##   .. .. ..$ score_7 : num [1:15808] 1.69 -1.661 0.211 0.837 0.117 ...
    ##   .. .. ..$ score_8 : num [1:15808] 0.9781 -1.2208 -0.14 0.0308 -0.5721 ...
    ##   .. .. ..$ score_9 : num [1:15808] -0.4773 -1.0502 -0.4129 -1.4805 -0.0243 ...
    ##   .. .. ..$ score_10: num [1:15808] 1.293 1.588 0.623 0.325 -0.129 ...
    ##   .. ..$ dens     :'data.frame': 401 obs. of  15809 variables:
    ##   .. .. ..$ x     : num [1:401] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. .. ..$ f1    : num [1:401] 0.857 0.868 0.88 0.891 0.903 ...
    ##   .. .. ..$ f2    : num [1:401] 1.02 1.13 1.24 1.35 1.46 ...
    ##   .. .. ..$ f3    : num [1:401] 0.562 0.59 0.619 0.648 0.676 ...
    ##   .. .. ..$ f4    : num [1:401] 0.774 0.791 0.808 0.825 0.842 ...
    ##   .. .. ..$ f5    : num [1:401] 0.629 0.684 0.739 0.795 0.851 ...
    ##   .. .. ..$ f6    : num [1:401] 0.932 0.951 0.971 0.991 1.01 ...
    ##   .. .. ..$ f7    : num [1:401] 1.07 1.13 1.18 1.24 1.29 ...
    ##   .. .. ..$ f8    : num [1:401] 0.199 0.187 0.175 0.163 0.15 ...
    ##   .. .. ..$ f9    : num [1:401] 0.768 0.766 0.764 0.762 0.76 ...
    ##   .. .. ..$ f10   : num [1:401] 0.226 0.201 0.176 0.15 0.124 ...
    ##   .. .. ..$ f11   : num [1:401] 0.312 0.285 0.257 0.229 0.2 ...
    ##   .. .. ..$ f12   : num [1:401] 0.735 0.742 0.748 0.755 0.761 ...
    ##   .. .. ..$ f13   : num [1:401] 0.19 0.242 0.296 0.35 0.404 ...
    ##   .. .. ..$ f14   : num [1:401] 0.729 0.742 0.755 0.768 0.78 ...
    ##   .. .. ..$ f15   : num [1:401] 0.319 0.301 0.283 0.264 0.245 ...
    ##   .. .. ..$ f16   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f17   : num [1:401] 0.366 0.34 0.314 0.287 0.26 ...
    ##   .. .. ..$ f18   : num [1:401] 1.01 1.1 1.2 1.3 1.4 ...
    ##   .. .. ..$ f19   : num [1:401] 0.0132 0 0 0 0 ...
    ##   .. .. ..$ f20   : num [1:401] 0.995 1.098 1.202 1.308 1.413 ...
    ##   .. .. ..$ f21   : num [1:401] 0.97 1.09 1.21 1.33 1.45 ...
    ##   .. .. ..$ f22   : num [1:401] 0.547 0.569 0.59 0.612 0.634 ...
    ##   .. .. ..$ f23   : num [1:401] 0.841 0.846 0.851 0.856 0.86 ...
    ##   .. .. ..$ f24   : num [1:401] 0.586 0.62 0.653 0.687 0.721 ...
    ##   .. .. ..$ f25   : num [1:401] 0.08404 0.04584 0.00675 0 0 ...
    ##   .. .. ..$ f26   : num [1:401] 0.826 0.909 0.994 1.079 1.165 ...
    ##   .. .. ..$ f27   : num [1:401] 0.76 0.757 0.754 0.75 0.747 ...
    ##   .. .. ..$ f28   : num [1:401] 0.738 0.739 0.74 0.741 0.742 ...
    ##   .. .. ..$ f29   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f30   : num [1:401] 0.714 0.7 0.684 0.669 0.653 ...
    ##   .. .. ..$ f31   : num [1:401] 0.718 0.704 0.689 0.674 0.659 ...
    ##   .. .. ..$ f32   : num [1:401] 0.721 0.709 0.696 0.683 0.671 ...
    ##   .. .. ..$ f33   : num [1:401] 0.214 0.388 0.565 0.745 0.924 ...
    ##   .. .. ..$ f34   : num [1:401] 0.0998 0.1689 0.2393 0.3105 0.3817 ...
    ##   .. .. ..$ f35   : num [1:401] 0.539 0.616 0.694 0.773 0.852 ...
    ##   .. .. ..$ f36   : num [1:401] 0.492 0.516 0.54 0.564 0.588 ...
    ##   .. .. ..$ f37   : num [1:401] 0.354 0.368 0.381 0.395 0.408 ...
    ##   .. .. ..$ f38   : num [1:401] 0.785 0.787 0.788 0.789 0.791 ...
    ##   .. .. ..$ f39   : num [1:401] 1.02 1.05 1.08 1.11 1.14 ...
    ##   .. .. ..$ f40   : num [1:401] 1.03 1.06 1.1 1.14 1.17 ...
    ##   .. .. ..$ f41   : num [1:401] 0.655 0.687 0.718 0.75 0.782 ...
    ##   .. .. ..$ f42   : num [1:401] 0.515 0.577 0.641 0.705 0.77 ...
    ##   .. .. ..$ f43   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f44   : num [1:401] 0.1404 0.1201 0.0991 0.0779 0.0565 ...
    ##   .. .. ..$ f45   : num [1:401] 1.05 1.09 1.13 1.17 1.21 ...
    ##   .. .. ..$ f46   : num [1:401] 0.647 0.689 0.732 0.775 0.818 ...
    ##   .. .. ..$ f47   : num [1:401] 0.743 0.737 0.73 0.723 0.716 ...
    ##   .. .. ..$ f48   : num [1:401] 0.607 0.64 0.674 0.708 0.741 ...
    ##   .. .. ..$ f49   : num [1:401] 0.487 0.517 0.547 0.578 0.608 ...
    ##   .. .. ..$ f50   : num [1:401] 0.74 0.735 0.73 0.724 0.718 ...
    ##   .. .. ..$ f51   : num [1:401] 0.751 0.747 0.742 0.736 0.731 ...
    ##   .. .. ..$ f52   : num [1:401] 0.128 0.288 0.45 0.615 0.779 ...
    ##   .. .. ..$ f53   : num [1:401] 0.76 0.757 0.754 0.75 0.747 ...
    ##   .. .. ..$ f54   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f55   : num [1:401] 0.184 0.1603 0.1359 0.1111 0.0862 ...
    ##   .. .. ..$ f56   : num [1:401] 0.341 0.352 0.363 0.375 0.386 ...
    ##   .. .. ..$ f57   : num [1:401] 0.1385 0.1225 0.1061 0.0893 0.0725 ...
    ##   .. .. ..$ f58   : num [1:401] 0.956 1.002 1.049 1.095 1.142 ...
    ##   .. .. ..$ f59   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f60   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f61   : num [1:401] 0.32 0.328 0.334 0.341 0.348 ...
    ##   .. .. ..$ f62   : num [1:401] 0.714 0.7 0.685 0.67 0.655 ...
    ##   .. .. ..$ f63   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f64   : num [1:401] 0.34 0.318 0.295 0.272 0.249 ...
    ##   .. .. ..$ f65   : num [1:401] 0 0 0.0508 0.1324 0.214 ...
    ##   .. .. ..$ f66   : num [1:401] 0.724 0.739 0.754 0.769 0.784 ...
    ##   .. .. ..$ f67   : num [1:401] 0.739 0.738 0.736 0.734 0.732 ...
    ##   .. .. ..$ f68   : num [1:401] 0.72 0.708 0.695 0.682 0.668 ...
    ##   .. .. ..$ f69   : num [1:401] 1.06 1.13 1.19 1.26 1.33 ...
    ##   .. .. ..$ f70   : num [1:401] 0.305 0.31 0.316 0.321 0.326 ...
    ##   .. .. ..$ f71   : num [1:401] 0.506 0.544 0.582 0.62 0.659 ...
    ##   .. .. ..$ f72   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f73   : num [1:401] 0.295 0.37 0.447 0.525 0.603 ...
    ##   .. .. ..$ f74   : num [1:401] 1 1.1 1.21 1.31 1.42 ...
    ##   .. .. ..$ f75   : num [1:401] 0.715 0.7 0.685 0.669 0.654 ...
    ##   .. .. ..$ f76   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f77   : num [1:401] 0.39 0.389 0.387 0.385 0.383 ...
    ##   .. .. ..$ f78   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f79   : num [1:401] 0.597 0.763 0.933 1.103 1.274 ...
    ##   .. .. ..$ f80   : num [1:401] 0.91 0.997 1.085 1.173 1.262 ...
    ##   .. .. ..$ f81   : num [1:401] 0.481 0.51 0.539 0.568 0.597 ...
    ##   .. .. ..$ f82   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f83   : num [1:401] 0.998 1.113 1.23 1.348 1.466 ...
    ##   .. .. ..$ f84   : num [1:401] 0.156 0.309 0.465 0.623 0.781 ...
    ##   .. .. ..$ f85   : num [1:401] 0.0977 0.0711 0.0438 0.0161 0 ...
    ##   .. .. ..$ f86   : num [1:401] 0.244 0.253 0.262 0.271 0.28 ...
    ##   .. .. ..$ f87   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f88   : num [1:401] 0.341 0.478 0.617 0.757 0.897 ...
    ##   .. .. ..$ f89   : num [1:401] 0.479 0.615 0.753 0.893 1.032 ...
    ##   .. .. ..$ f90   : num [1:401] 0.57 0.641 0.713 0.786 0.859 ...
    ##   .. .. ..$ f91   : num [1:401] 0.348 0.445 0.544 0.643 0.743 ...
    ##   .. .. ..$ f92   : num [1:401] 0.309 0.338 0.368 0.399 0.429 ...
    ##   .. .. ..$ f93   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f94   : num [1:401] 0.653 0.647 0.641 0.635 0.629 ...
    ##   .. .. ..$ f95   : num [1:401] 1 1.1 1.2 1.3 1.41 ...
    ##   .. .. ..$ f96   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f97   : num [1:401] 0.972 1.091 1.211 1.333 1.455 ...
    ##   .. .. ..$ f98   : num [1:401] 0.653 0.709 0.765 0.822 0.879 ...
    ##   .. .. .. [list output truncated]
    ##   .. ..$ deriv    :'data.frame': 399 obs. of  15809 variables:
    ##   .. .. ..$ dx     : num [1:399] 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 0.025 ...
    ##   .. .. ..$ df1    : num [1:399] 4.63 4.58 4.59 4.66 4.79 ...
    ##   .. .. ..$ df2    : num [1:399] 44 44.5 44.7 44.7 44.3 ...
    ##   .. .. ..$ df3    : num [1:399] 11.4 11.5 11.5 11.5 11.4 ...
    ##   .. .. ..$ df4    : num [1:399] 6.83 6.81 6.81 6.84 6.89 ...
    ##   .. .. ..$ df5    : num [1:399] 22.1 22.3 22.4 22.3 22.2 ...
    ##   .. .. ..$ df6    : num [1:399] 7.86 7.85 7.88 7.94 8.05 ...
    ##   .. .. ..$ df7    : num [1:399] 22 22.2 22.3 22.4 22.3 ...
    ##   .. .. ..$ df8    : num [1:399] -4.76 -4.9 -4.97 -4.99 -4.94 ...
    ##   .. .. ..$ df9    : num [1:399] -0.634 -0.753 -0.776 -0.698 -0.52 ...
    ##   .. .. ..$ df10   : num [1:399] -10 -10.2 -10.3 -10.3 -10.2 ...
    ##   .. .. ..$ df11   : num [1:399] -11 -11.2 -11.3 -11.3 -11.1 ...
    ##   .. .. ..$ df12   : num [1:399] 2.65 2.57 2.54 2.58 2.68 ...
    ##   .. .. ..$ df13   : num [1:399] 21.2 21.5 21.6 21.5 21.3 ...
    ##   .. .. ..$ df14   : num [1:399] 5.13 5.08 5.07 5.1 5.16 ...
    ##   .. .. ..$ df15   : num [1:399] -7.18 -7.36 -7.44 -7.41 -7.27 ...
    ##   .. .. ..$ df16   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df17   : num [1:399] -10.4 -10.6 -10.7 -10.7 -10.5 ...
    ##   .. .. ..$ df18   : num [1:399] 38.7 39.2 39.4 39.4 39.1 ...
    ##   .. .. ..$ df19   : num [1:399] -2.63 0 0 0 0 ...
    ##   .. .. ..$ df20   : num [1:399] 41.5 42 42.2 42.2 41.8 ...
    ##   .. .. ..$ df21   : num [1:399] 47.5 48.1 48.4 48.3 47.9 ...
    ##   .. .. ..$ df22   : num [1:399] 8.59 8.63 8.64 8.63 8.6 ...
    ##   .. .. ..$ df23   : num [1:399] 2.01 1.92 1.91 1.98 2.14 ...
    ##   .. .. ..$ df24   : num [1:399] 13.4 13.5 13.6 13.5 13.4 ...
    ##   .. .. ..$ df25   : num [1:399] -15.46 -9.17 -1.35 0 0 ...
    ##   .. .. ..$ df26   : num [1:399] 33.5 34 34.1 34.1 33.8 ...
    ##   .. .. ..$ df27   : num [1:399] -1.23 -1.35 -1.38 -1.3 -1.12 ...
    ##   .. .. ..$ df28   : num [1:399] 0.472 0.358 0.325 0.375 0.51 ...
    ##   .. .. ..$ df29   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df30   : num [1:399] -5.97 -6.17 -6.23 -6.15 -5.92 ...
    ##   .. .. ..$ df31   : num [1:399] -5.79 -5.99 -6.05 -5.97 -5.74 ...
    ##   .. .. ..$ df32   : num [1:399] -4.92 -5.1 -5.15 -5.07 -4.85 ...
    ##   .. .. ..$ df33   : num [1:399] 70.2 71.3 71.7 71.5 70.7 ...
    ##   .. .. ..$ df34   : num [1:399] 27.9 28.3 28.5 28.4 28 ...
    ##   .. .. ..$ df35   : num [1:399] 31 31.4 31.5 31.5 31.2 ...
    ##   .. .. ..$ df36   : num [1:399] 9.6 9.66 9.69 9.69 9.65 ...
    ##   .. .. ..$ df37   : num [1:399] 5.42 5.42 5.4 5.37 5.32 ...
    ##   .. .. ..$ df38   : num [1:399] 0.633 0.531 0.517 0.593 0.759 ...
    ##   .. .. ..$ df39   : num [1:399] 12.4 12.4 12.4 12.5 12.6 ...
    ##   .. .. ..$ df40   : num [1:399] 14.2 14.3 14.4 14.4 14.5 ...
    ##   .. .. ..$ df41   : num [1:399] 12.6 12.7 12.7 12.7 12.6 ...
    ##   .. .. ..$ df42   : num [1:399] 25.3 25.6 25.7 25.7 25.4 ...
    ##   .. .. ..$ df43   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df44   : num [1:399] -8.25 -8.44 -8.53 -8.54 -8.45 ...
    ##   .. .. ..$ df45   : num [1:399] 15.9 16 16.1 16.1 16.1 ...
    ##   .. .. ..$ df46   : num [1:399] 16.9 17.1 17.2 17.2 17.1 ...
    ##   .. .. ..$ df47   : num [1:399] -2.66 -2.81 -2.84 -2.76 -2.57 ...
    ##   .. .. ..$ df48   : num [1:399] 13.4 13.5 13.5 13.5 13.4 ...
    ##   .. .. ..$ df49   : num [1:399] 12 12.1 12.2 12.2 12.1 ...
    ##   .. .. ..$ df50   : num [1:399] -2.15 -2.3 -2.34 -2.28 -2.1 ...
    ##   .. .. ..$ df51   : num [1:399] -1.95 -2.09 -2.12 -2.04 -1.85 ...
    ##   .. .. ..$ df52   : num [1:399] 64.4 65.4 65.8 65.6 64.8 ...
    ##   .. .. ..$ df53   : num [1:399] -1.23 -1.35 -1.38 -1.3 -1.12 ...
    ##   .. .. ..$ df54   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df55   : num [1:399] -9.63 -9.84 -9.94 -9.93 -9.82 ...
    ##   .. .. ..$ df56   : num [1:399] 4.57 4.55 4.53 4.5 4.46 ...
    ##   .. .. ..$ df57   : num [1:399] -6.49 -6.64 -6.71 -6.71 -6.63 ...
    ##   .. .. ..$ df58   : num [1:399] 18.5 18.6 18.7 18.7 18.7 ...
    ##   .. .. ..$ df59   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df60   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df61   : num [1:399] 2.79 2.75 2.72 2.69 2.67 ...
    ##   .. .. ..$ df62   : num [1:399] -5.77 -5.97 -6.03 -5.95 -5.72 ...
    ##   .. .. ..$ df63   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df64   : num [1:399] -8.99 -9.2 -9.29 -9.26 -9.1 ...
    ##   .. .. ..$ df65   : num [1:399] 10.2 26.5 32.6 32.5 32.1 ...
    ##   .. .. ..$ df66   : num [1:399] 6.02 5.99 5.98 6 6.04 ...
    ##   .. .. ..$ df67   : num [1:399] -0.56 -0.689 -0.726 -0.67 -0.519 ...
    ##   .. .. ..$ df68   : num [1:399] -5.04 -5.22 -5.28 -5.19 -4.97 ...
    ##   .. .. ..$ df69   : num [1:399] 27.4 27.6 27.8 27.8 27.7 ...
    ##   .. .. ..$ df70   : num [1:399] 2.21 2.16 2.13 2.1 2.08 ...
    ##   .. .. ..$ df71   : num [1:399] 15.1 15.3 15.3 15.3 15.2 ...
    ##   .. .. ..$ df72   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df73   : num [1:399] 30.6 31 31.1 31 30.7 ...
    ##   .. .. ..$ df74   : num [1:399] 41.2 41.7 41.9 41.8 41.5 ...
    ##   .. .. ..$ df75   : num [1:399] -5.96 -6.16 -6.23 -6.14 -5.91 ...
    ##   .. .. ..$ df76   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df77   : num [1:399] -0.686 -0.788 -0.842 -0.847 -0.803 ...
    ##   .. .. ..$ df78   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df79   : num [1:399] 67 68 68.4 68.2 67.5 ...
    ##   .. .. ..$ df80   : num [1:399] 34.9 35.3 35.5 35.4 35.2 ...
    ##   .. .. ..$ df81   : num [1:399] 11.5 11.6 11.6 11.6 11.5 ...
    ##   .. .. ..$ df82   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df83   : num [1:399] 46.4 47 47.2 47.1 46.7 ...
    ##   .. .. ..$ df84   : num [1:399] 61.9 62.8 63.2 63 62.2 ...
    ##   .. .. ..$ df85   : num [1:399] -10.77 -10.99 -8.76 -3.22 0 ...
    ##   .. .. ..$ df86   : num [1:399] 3.67 3.65 3.62 3.59 3.54 ...
    ##   .. .. ..$ df87   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df88   : num [1:399] 55 55.8 56.1 56 55.3 ...
    ##   .. .. ..$ df89   : num [1:399] 54.8 55.5 55.8 55.7 55.1 ...
    ##   .. .. ..$ df90   : num [1:399] 28.6 29 29.1 29.1 28.8 ...
    ##   .. .. ..$ df91   : num [1:399] 39.1 39.7 39.9 39.8 39.4 ...
    ##   .. .. ..$ df92   : num [1:399] 11.9 12.1 12.1 12.1 12 ...
    ##   .. .. ..$ df93   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df94   : num [1:399] -2.31 -2.45 -2.49 -2.43 -2.26 ...
    ##   .. .. ..$ df95   : num [1:399] 40.2 40.7 41 40.9 40.6 ...
    ##   .. .. ..$ df96   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df97   : num [1:399] 47.9 48.5 48.8 48.7 48.3 ...
    ##   .. .. ..$ df98   : num [1:399] 22.4 22.7 22.8 22.7 22.5 ...
    ##   .. .. .. [list output truncated]
    ##   .. ..$ mean     :'data.frame': 401 obs. of  2 variables:
    ##   .. .. ..$ x   : num [1:401] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. .. ..$ f_mu: num [1:401] 0.369 0.394 0.42 0.446 0.472 ...
    ##   .. ..$ basis    :'data.frame': 401 obs. of  11 variables:
    ##   .. .. ..$ x       : num [1:401] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. .. ..$ basis_1 : num [1:401] 0.221 0.288 0.357 0.426 0.495 ...
    ##   .. .. ..$ basis_2 : num [1:401] -0.315 -0.298 -0.28 -0.262 -0.244 ...
    ##   .. .. ..$ basis_3 : num [1:401] -0.582 -0.628 -0.674 -0.72 -0.767 ...
    ##   .. .. ..$ basis_4 : num [1:401] -0.0225 -0.0642 -0.1067 -0.1497 -0.1927 ...
    ##   .. .. ..$ basis_5 : num [1:401] -0.915 -0.945 -0.975 -1.005 -1.035 ...
    ##   .. .. ..$ basis_6 : num [1:401] -0.888 -0.849 -0.807 -0.765 -0.722 ...
    ##   .. .. ..$ basis_7 : num [1:401] -1.09 -1.15 -1.22 -1.28 -1.35 ...
    ##   .. .. ..$ basis_8 : num [1:401] -1.81 -1.77 -1.73 -1.68 -1.63 ...
    ##   .. .. ..$ basis_9 : num [1:401] -0.337 -0.427 -0.518 -0.608 -0.696 ...
    ##   .. .. ..$ basis_10: num [1:401] 2.32 2.29 2.25 2.21 2.17 ...
    ##   .. ..$ baseline : num [1:10] 0.8923 -0.4145 0.1766 0.1526 -0.0137 ...
    ##   .. ..$ ValidPred:List of 4
    ##   .. .. ..$ scores     : num [1:290, 1:10] -0.582 -0.462 -0.204 -0.261 0.557 ...
    ##   .. .. .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. .. .. ..$ : chr [1:290] "90001" "90002" "90003" "90005" ...
    ##   .. .. .. .. ..$ : chr [1:10] "basis_1" "basis_2" "basis_3" "basis_4" ...
    ##   .. .. ..$ densities  : num [1:401, 1:291] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. .. .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. .. .. ..$ : NULL
    ##   .. .. .. .. ..$ : chr [1:291] "" "90001" "90002" "90003" ...
    ##   .. .. ..$ derivatives: num [1:399, 1:291] 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 0.025 ...
    ##   .. .. .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. .. .. ..$ : NULL
    ##   .. .. .. .. ..$ : chr [1:291] "" "90001" "90002" "90003" ...
    ##   .. .. ..$ baseline   : num [1:10] 0.8923 -0.4145 0.1766 0.1526 -0.0137 ...
    ##   ..$ pred3:List of 8
    ##   .. ..$ K        : int 3
    ##   .. ..$ scores   :'data.frame': 5998 obs. of  11 variables:
    ##   .. .. ..$ id      : chr [1:5998] "1" "2" "3" "4" ...
    ##   .. .. ..$ score_1 : num [1:5998] 0.0863 1.7192 -2.6026 1.3053 -1.4638 ...
    ##   .. .. ..$ score_2 : num [1:5998] 0.999 -0.154 -2.317 1.686 -0.569 ...
    ##   .. .. ..$ score_3 : num [1:5998] -0.188338 0.000578 0.747628 -0.439457 0.293587 ...
    ##   .. .. ..$ score_4 : num [1:5998] -1.046 1.302 0.801 -0.197 -0.451 ...
    ##   .. .. ..$ score_5 : num [1:5998] 0.3414 1.2492 -0.589 -0.2272 -0.0544 ...
    ##   .. .. ..$ score_6 : num [1:5998] -0.104 -0.69 0.641 0.406 -0.665 ...
    ##   .. .. ..$ score_7 : num [1:5998] -0.0857 0.3014 2.6718 0.9248 -2.414 ...
    ##   .. .. ..$ score_8 : num [1:5998] -0.1933 -0.0408 -1.3456 0.4373 1.2886 ...
    ##   .. .. ..$ score_9 : num [1:5998] 0.161 0.236 0.418 -0.394 -0.439 ...
    ##   .. .. ..$ score_10: num [1:5998] 0.0799 0.2574 0.2118 -0.1484 -0.1655 ...
    ##   .. ..$ dens     :'data.frame': 401 obs. of  5999 variables:
    ##   .. .. ..$ x    : num [1:401] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. .. ..$ f1   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f2   : num [1:401] 0.0452 0.0517 0.0588 0.0664 0.0745 ...
    ##   .. .. ..$ f3   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f4   : num [1:401] 0.0053 0.00593 0.00658 0.00723 0.00785 ...
    ##   .. .. ..$ f5   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f6   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f7   : num [1:401] 0.0193 0.022 0.0249 0.028 0.0312 ...
    ##   .. .. ..$ f8   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f9   : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f10  : num [1:401] 1.29e-04 1.77e-05 0.00 0.00 0.00 ...
    ##   .. .. ..$ f11  : num [1:401] 0.0284 0.0324 0.0367 0.0414 0.0463 ...
    ##   .. .. ..$ f12  : num [1:401] 0.00497 0.00553 0.00609 0.00662 0.00712 ...
    ##   .. .. ..$ f13  : num [1:401] 0.128 0.147 0.168 0.19 0.214 ...
    ##   .. .. ..$ f14  : num [1:401] 0.217 0.25 0.286 0.325 0.368 ...
    ##   .. .. ..$ f15  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f16  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f17  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f18  : num [1:401] 0.00657 0.00737 0.00819 0.00902 0.00982 ...
    ##   .. .. ..$ f19  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f20  : num [1:401] 0.0102 0.0115 0.0129 0.0144 0.0159 ...
    ##   .. .. ..$ f21  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f22  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f23  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f24  : num [1:401] 0.00255 0.00277 0.00296 0.00311 0.00319 ...
    ##   .. .. ..$ f25  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f26  : num [1:401] 0.00592 0.00663 0.00735 0.00806 0.00875 ...
    ##   .. .. ..$ f27  : num [1:401] 0.00592 0.00661 0.00732 0.00802 0.00869 ...
    ##   .. .. ..$ f28  : num [1:401] 0.0145 0.0164 0.0186 0.0208 0.0231 ...
    ##   .. .. ..$ f29  : num [1:401] 0.0156 0.0177 0.02 0.0225 0.025 ...
    ##   .. .. ..$ f30  : num [1:401] 1.28e-04 9.11e-06 0.00 0.00 0.00 ...
    ##   .. .. ..$ f31  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f32  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f33  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f34  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f35  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f36  : num [1:401] 0.0111 0.0125 0.0141 0.0158 0.0175 ...
    ##   .. .. ..$ f37  : num [1:401] 0.0987 0.1135 0.1297 0.1474 0.1667 ...
    ##   .. .. ..$ f38  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f39  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f40  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f41  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f42  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f43  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f44  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f45  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f46  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f47  : num [1:401] 0.304 0.35 0.401 0.457 0.517 ...
    ##   .. .. ..$ f48  : num [1:401] 0.0119 0.0135 0.0152 0.0169 0.0188 ...
    ##   .. .. ..$ f49  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f50  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f51  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f52  : num [1:401] 0.313 0.361 0.413 0.47 0.532 ...
    ##   .. .. ..$ f53  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f54  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f55  : num [1:401] 0.00173 0.00184 0.00191 0.00192 0.00186 ...
    ##   .. .. ..$ f56  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f57  : num [1:401] 0.0117 0.0133 0.0149 0.0167 0.0185 ...
    ##   .. .. ..$ f58  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f59  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f60  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f61  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f62  : num [1:401] 0.00147 0.00154 0.00158 0.00156 0.00147 ...
    ##   .. .. ..$ f63  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f64  : num [1:401] 0.000845 0.0009 0.000938 0.000951 0.00093 ...
    ##   .. .. ..$ f65  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f66  : num [1:401] 0.000449 0.000448 0.000425 0.000372 0.00028 ...
    ##   .. .. ..$ f67  : num [1:401] 0 0 0 0 0 ...
    ##   .. .. ..$ f68  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f69  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f70  : num [1:401] 0.136 0.156 0.177 0.201 0.227 ...
    ##   .. .. ..$ f71  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f72  : num [1:401] 0.0108 0.0124 0.0141 0.016 0.018 ...
    ##   .. .. ..$ f73  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f74  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f75  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f76  : num [1:401] 0.0389 0.0445 0.0506 0.0571 0.0641 ...
    ##   .. .. ..$ f77  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f78  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f79  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f80  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f81  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f82  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f83  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f84  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f85  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f86  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f87  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f88  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f89  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f90  : num [1:401] 0.00187 0.0021 0.00235 0.0026 0.00285 ...
    ##   .. .. ..$ f91  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f92  : num [1:401] 5.72e-06 0.00 0.00 0.00 0.00 ...
    ##   .. .. ..$ f93  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f94  : num [1:401] 0.0561 0.0641 0.0729 0.0823 0.0924 ...
    ##   .. .. ..$ f95  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f96  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f97  : num [1:401] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ f98  : num [1:401] 0.00161 0.00231 0.00323 0.00441 0.00592 ...
    ##   .. .. .. [list output truncated]
    ##   .. ..$ deriv    :'data.frame': 399 obs. of  5999 variables:
    ##   .. .. ..$ dx    : num [1:399] 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 0.025 ...
    ##   .. .. ..$ df1   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df2   : num [1:399] 2.71 2.94 3.16 3.36 3.54 ...
    ##   .. .. ..$ df3   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df4   : num [1:399] 0.256 0.258 0.253 0.239 0.214 ...
    ##   .. .. ..$ df5   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df6   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df7   : num [1:399] 1.12 1.2 1.27 1.33 1.38 ...
    ##   .. .. ..$ df8   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df9   : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df10  : num [1:399] -0.0258 -0.00355 0 0 0 ...
    ##   .. .. ..$ df11  : num [1:399] 1.67 1.8 1.92 2.03 2.11 ...
    ##   .. .. ..$ df12  : num [1:399] 0.223 0.219 0.207 0.184 0.149 ...
    ##   .. .. ..$ df13  : num [1:399] 7.88 8.59 9.3 9.97 10.62 ...
    ##   .. .. ..$ df14  : num [1:399] 13.7 15.1 16.5 17.8 19.2 ...
    ##   .. .. ..$ df15  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df16  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df17  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df18  : num [1:399] 0.324 0.329 0.327 0.313 0.288 ...
    ##   .. .. ..$ df19  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df20  : num [1:399] 0.548 0.575 0.593 0.601 0.596 ...
    ##   .. .. ..$ df21  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df22  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df23  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df24  : num [1:399] 0.082 0.0672 0.0446 0.013 -0.0288 ...
    ##   .. .. ..$ df25  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df26  : num [1:399] 0.285 0.287 0.281 0.265 0.237 ...
    ##   .. .. ..$ df27  : num [1:399] 0.281 0.282 0.274 0.255 0.224 ...
    ##   .. .. ..$ df28  : num [1:399] 0.813 0.864 0.906 0.937 0.954 ...
    ##   .. .. ..$ df29  : num [1:399] 0.887 0.946 0.997 1.037 1.064 ...
    ##   .. .. ..$ df30  : num [1:399] -0.02558 -0.00182 0 0 0 ...
    ##   .. .. ..$ df31  : num [1:399] 0 0 0 0 0 ...
    ##   .. .. ..$ df32  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df33  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df34  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df35  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df36  : num [1:399] 0.611 0.646 0.673 0.69 0.695 ...
    ##   .. .. ..$ df37  : num [1:399] 6.19 6.79 7.39 7.99 8.57 ...
    ##   .. .. ..$ df38  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df39  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df40  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df41  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df42  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df43  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df44  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df45  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df46  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df47  : num [1:399] 19.3 21.2 23.2 25.2 27.1 ...
    ##   .. .. ..$ df48  : num [1:399] 0.659 0.697 0.728 0.748 0.756 ...
    ##   .. .. ..$ df49  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df50  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df51  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df52  : num [1:399] 19.9 21.9 23.9 26 28 ...
    ##   .. .. ..$ df53  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df54  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df55  : num [1:399] 0.03432 0.01599 -0.00975 -0.04413 -0.08814 ...
    ##   .. .. ..$ df56  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df57  : num [1:399] 0.648 0.685 0.715 0.733 0.74 ...
    ##   .. .. ..$ df58  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df59  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df60  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df61  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df62  : num [1:399] 0.02156 0.00307 -0.02247 -0.05623 -0.09913 ...
    ##   .. .. ..$ df63  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df64  : num [1:399] 0.01861 0.0102 -0.00175 -0.01785 -0.03855 ...
    ##   .. .. ..$ df65  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df66  : num [1:399] -0.00492 -0.01522 -0.02895 -0.04666 -0.05596 ...
    ##   .. .. ..$ df67  : num [1:399] 0 0 0 0.00292 0.04191 ...
    ##   .. .. ..$ df68  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df69  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df70  : num [1:399] 8.38 9.15 9.91 10.66 11.37 ...
    ##   .. .. ..$ df71  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df72  : num [1:399] 0.658 0.715 0.77 0.822 0.87 ...
    ##   .. .. ..$ df73  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df74  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df75  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df76  : num [1:399] 2.33 2.52 2.71 2.87 3.02 ...
    ##   .. .. ..$ df77  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df78  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df79  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df80  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df81  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df82  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df83  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df84  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df85  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df86  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df87  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df88  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df89  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df90  : num [1:399] 0.0964 0.0994 0.1003 0.0985 0.0936 ...
    ##   .. .. ..$ df91  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df92  : num [1:399] -0.00114 0 0 0 0 ...
    ##   .. .. ..$ df93  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df94  : num [1:399] 3.36 3.63 3.9 4.14 4.36 ...
    ##   .. .. ..$ df95  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df96  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df97  : num [1:399] 0 0 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..$ df98  : num [1:399] 0.325 0.42 0.537 0.679 0.848 ...
    ##   .. .. .. [list output truncated]
    ##   .. ..$ mean     :'data.frame': 401 obs. of  2 variables:
    ##   .. .. ..$ x   : num [1:401] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. .. ..$ f_mu: num [1:401] 0.00138 0.0018 0.00233 0.00299 0.00381 ...
    ##   .. ..$ basis    :'data.frame': 401 obs. of  11 variables:
    ##   .. .. ..$ x       : num [1:401] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. .. ..$ basis_1 : num [1:401] 0.000941 0.00091 0.000823 0.000664 0.000409 ...
    ##   .. .. ..$ basis_2 : num [1:401] -0.0403 -0.0465 -0.0534 -0.061 -0.0693 ...
    ##   .. .. ..$ basis_3 : num [1:401] -0.163 -0.188 -0.215 -0.245 -0.277 ...
    ##   .. .. ..$ basis_4 : num [1:401] -0.0107 -0.0122 -0.0139 -0.0156 -0.0175 ...
    ##   .. .. ..$ basis_5 : num [1:401] -0.0126 -0.0144 -0.0165 -0.0187 -0.0211 ...
    ##   .. .. ..$ basis_6 : num [1:401] -0.0249 -0.0283 -0.0321 -0.0362 -0.0405 ...
    ##   .. .. ..$ basis_7 : num [1:401] -0.0085 -0.00943 -0.01034 -0.01119 -0.01194 ...
    ##   .. .. ..$ basis_8 : num [1:401] 0.008 0.00879 0.00955 0.01023 0.01081 ...
    ##   .. .. ..$ basis_9 : num [1:401] -0.0481 -0.0547 -0.0618 -0.0695 -0.0777 ...
    ##   .. .. ..$ basis_10: num [1:401] 0.11 0.125 0.141 0.158 0.176 ...
    ##   .. ..$ baseline : num [1:10] -1.8945 0.4612 -0.1163 -0.102 0.0197 ...
    ##   .. ..$ ValidPred:List of 4
    ##   .. .. ..$ scores     : num [1:83, 1:10] 0.151 1.61 0.693 1.066 1.703 ...
    ##   .. .. .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. .. .. ..$ : chr [1:83] "90003" "90010" "90027" "90032" ...
    ##   .. .. .. .. ..$ : chr [1:10] "basis_1" "basis_2" "basis_3" "basis_4" ...
    ##   .. .. ..$ densities  : num [1:401, 1:84] 0 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 ...
    ##   .. .. .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. .. .. ..$ : NULL
    ##   .. .. .. .. ..$ : chr [1:84] "" "90003" "90010" "90027" ...
    ##   .. .. ..$ derivatives: num [1:399, 1:84] 0.0025 0.005 0.0075 0.01 0.0125 0.015 0.0175 0.02 0.0225 0.025 ...
    ##   .. .. .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. .. .. ..$ : NULL
    ##   .. .. .. .. ..$ : chr [1:84] "" "90003" "90010" "90027" ...
    ##   .. .. ..$ baseline   : num [1:10] -1.8945 0.4612 -0.1163 -0.102 0.0197 ...

``` r
proc.time()
```

    ##    user  system elapsed 
    ## 123.422  10.392  89.963
